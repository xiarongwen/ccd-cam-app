# CCD复古胶片相机 - 开发指南

## 🚀 快速开始

### 1. 环境准备
- macOS 12.0 或更高版本
- Xcode 14.0 或更高版本
- iOS 15.0+ 的设备或模拟器

### 2. 项目配置

#### 2.1 打开项目
```bash
cd /Users/it/study/ccd
open ccd.xcodeproj
```

#### 2.2 配置权限
在 Xcode 中：
1. 选择项目文件（顶部的 ccd）
2. 选择 Target "ccd"
3. 选择 "Info" 标签
4. 添加以下权限：

- **Camera Usage Description**: "CCD相机需要使用您的相机来拍摄照片并应用复古滤镜效果"
- **Photo Library Additions Usage Description**: "CCD相机需要将拍摄的照片保存到您的相册"

#### 2.3 配置开发团队
1. 选择 "Signing & Capabilities" 标签
2. 勾选 "Automatically manage signing"
3. 选择你的开发团队

### 3. 运行项目

#### 3.1 选择运行目标
- 真机测试（推荐）：连接 iPhone 并选择设备
- 模拟器测试：选择 iPhone 14 Pro 或其他模拟器

#### 3.2 运行
- 点击运行按钮（▶️）或按 `Cmd + R`

### 4. 功能测试

#### 4.1 相机功能
- 点击快门按钮拍照
- 双击屏幕对焦
- 捏合手势缩放
- 点击闪光灯图标切换闪光模式
- 点击切换相机图标切换前后摄像头

#### 4.2 滤镜功能
- 点击右下角滤镜按钮打开滤镜选择器
- 选择不同分类查看滤镜
- 点击滤镜卡片应用效果
- 当前滤镜名称会显示在取景器左下角

#### 4.3 保存功能
- 拍照后会自动应用当前滤镜
- 照片会保存到系统相册
- 成功保存会有震动反馈

## 📱 UI/UX 特色

### 复古拟物设计
- **机身质感**：深灰色背景模拟老相机机身
- **取景器**：圆角矩形边框，带阴影效果
- **快门按钮**：双层圆环设计，渐变填充
- **控制按钮**：凹陷效果的圆形按钮
- **滤镜卡片**：模拟胶片盒设计，带胶片孔装饰

### 交互反馈
- **触感反馈**：拍照时中等强度震动
- **视觉反馈**：快门动画、对焦动画
- **声音反馈**：（可选）模拟机械快门声

## 🛠 开发注意事项

### 1. 性能优化
- 滤镜处理使用 Metal GPU 加速
- 避免在主线程进行图像处理
- 及时释放不需要的图像资源

### 2. 内存管理
- 使用 `@StateObject` 管理相机服务生命周期
- 图像处理后及时释放原图
- 避免同时处理多张高分辨率图片

### 3. 错误处理
- 相机权限被拒绝时的提示
- 保存失败时的错误反馈
- 滤镜处理失败的降级方案

## 🎨 自定义滤镜

如需添加新滤镜：

1. 在 `FilterType.swift` 中添加新的枚举值
2. 在 `FilterEngine.swift` 中实现滤镜算法
3. 更新 `FilterSelectorView.swift` 中的分类

示例：
```swift
// FilterType.swift
case myCustomFilter = "my_custom_filter"

// FilterEngine.swift
private func applyMyCustomFilter(to image: CIImage) -> CIImage {
    // 实现你的滤镜效果
}
```

## 📋 待办事项

- [x] ✅ 实现相册浏览功能 - **已完成并集成**
- [x] ✅ 添加照片编辑功能 - **已完成并集成**
- [x] ✅ 实现批量处理 - **已完成并集成**
- [x] ✅ 添加更多滤镜效果 - **已完成并集成**
- [x] ✅ 实现滤镜强度调节 - **已完成并集成**
- [x] ✅ 实现社交分享功能 - **已完成并集成**
- [x] ✅ 创建完整的设置页面 - **已完成并集成**
- [ ] 添加时间戳水印（已有基础实现，需要完善）

### 🆕 新增功能状态
- [x] ✅ 创建了完整的相册浏览界面（GalleryView）- **已集成到主界面**
- [x] ✅ 实现了批量照片处理功能（BatchProcessView）- **已集成到主界面**
- [x] ✅ 添加了滤镜强度调节（FilterIntensityView）- **已集成到滤镜选择器**
- [x] ✅ 完成了社交分享系统（ShareView）- **已集成到照片编辑界面**
- [x] ✅ 创建了完整的设置页面（SettingsView）- **已集成到主界面**
- [x] ✅ 扩展了FilterEngine以支持强度调节
- [x] ✅ 集成了所有新功能到主相机界面

### 📱 功能详情

#### 1. 相册浏览功能 ✅ **已完全集成**
- 网格式照片浏览
- 照片详情查看
- 滑动切换照片
- 删除照片功能
- 按滤镜分类显示
- **访问方式**: 主界面底部"ALBUM"按钮

#### 2. 批量处理功能 ✅ **已完全集成**
- 多选照片界面
- 实时效果预览
- 批量应用滤镜、相框、水印
- 进度显示和取消功能
- 一键全选/清空
- **访问方式**: 主界面底部"BATCH"按钮

#### 3. 滤镜强度调节 ✅ **已完全集成**
- 实时滑杆调节
- 预设强度快捷选择
- 实时预览效果
- 0-100%无级调节
- **访问方式**: 滤镜选择器中的"强度"按钮

#### 4. 社交分享功能 ✅ **已完全集成**
- 支持多个社交平台
- 自定义分享文案
- 系统分享表单
- 应用检测和智能切换
- **访问方式**: 照片编辑界面顶部分享按钮

#### 5. 设置页面 ✅ **已完全集成**
- 完整的应用设置
- 权限管理
- 帮助和教程
- 关于页面和隐私政策
- **访问方式**: 主界面顶部设置按钮或底部"MORE"按钮

### 🎯 主界面功能布局

#### 顶部控制区域
- **设置按钮** (左上) → 打开设置页面
- **闪光灯控制** (中左) → 切换闪光模式
- **前后摄像头切换** (右上) → 切换相机

#### 底部控制面板 (从左到右)
1. **BATCH** → 批量处理功能
2. **ALBUM** → 相册浏览功能  
3. **快门按钮** → 拍照
4. **FILTER** → 滤镜选择 (含强度调节)
5. **MORE** → 更多功能/设置

#### 照片编辑界面
- **分享按钮** (右上) → 社交分享功能
- **滤镜/相框/水印** → 完整编辑工具

## 🐛 已知问题

1. 模拟器上相机预览可能有延迟
2. 某些滤镜在低端设备上可能有性能问题
3. 横屏模式下UI布局需要优化

## 📞 联系支持

如有问题，请查看：
- [产品文档](./产品文档.md)
- [技术实现路线图](./技术实现路线图.md)
- [README](./README.md)

---

*最后更新：2025年5月23日* 